{% extends "bases.html" %}
{% load static %}

{% block title %}üè† –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç - {{ user.username }} - NLPers.ru{% endblock %}

{% block meny %}
  
{% endblock meny %}

{% block extra_css %}
<style>
.dashboard-header {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 3rem 0;
    margin-bottom: 2rem;
}

.avatar-large {
    width: 120px;
    height: 120px;
    border-radius: 50%;
    border: 4px solid white;
    box-shadow: 0 5px 15px rgba(0,0,0,0.2);
}

.stats-card {
    background: white;
    border-radius: 10px;
    padding: 1.5rem;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    margin-bottom: 1.5rem;
    transition: transform 0.3s ease;
}

.stats-card:hover {
    transform: translateY(-5px);
}

.stats-number {
    font-size: 2rem;
    font-weight: bold;
    color: #667eea;
}

.recent-posts .post-item {
    background: white;
    border-radius: 8px;
    padding: 1rem;
    margin-bottom: 1rem;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    transition: transform 0.2s ease;
}

.recent-posts .post-item:hover {
    transform: translateX(5px);
}

.action-buttons .btn {
    margin: 0.5rem;
    padding: 0.75rem 1.5rem;
    border-radius: 8px;
    font-weight: 600;
    transition: all 0.3s ease;
}

.btn-primary-custom {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    border: none;
    color: white;
}

.btn-success-custom {
    background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
    border: none;
    color: white;
}

.btn-info-custom {
    background: linear-gradient(135deg, #17a2b8 0%, #138496 100%);
    border: none;
    color: white;
}

.author-status {
    padding: 0.5rem 1rem;
    border-radius: 20px;
    font-weight: 600;
    display: inline-block;
}

.status-pending {
    background: #fff3cd;
    color: #856404;
    border: 1px solid #ffeaa7;
}

.status-approved {
    background: #d4edda;
    color: #155724;
    border: 1px solid #c3e6cb;
}

.status-none {
    background: #f8f9fa;
    color: #6c757d;
    border: 1px solid #dee2e6;
}

.status-rejected {
    background: #f8d7da;
    color: #721c24;
    border: 1px solid #f5c6cb;
}
</style>
{% endblock %}

{% block content %}
<!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ –ø–∞–Ω–µ–ª–∏ -->
<div class="dashboard-header">
    <div class="container">
        <div class="row align-items-center">
            <div class="col-md-3 text-center">
                {% if user_profile.avatar %}
                    <img src="{{ user_profile.avatar.url }}" alt="{{ user.username }}" class="avatar-large">
                {% else %}
                    <div class="avatar-large bg-light d-flex align-items-center justify-content-center">
                        <i class="fas fa-user fa-3x text-muted"></i>
                    </div>
                {% endif %}
            </div>
            <div class="col-md-9">
                <h1 class="mb-2">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, {{ user.first_name|default:user.username }}! üëã</h1>
                <p class="mb-3 opacity-75">{{ user.email }}</p>
                
                <!-- –°—Ç–∞—Ç—É—Å –∞–≤—Ç–æ—Ä–∞ -->
                <div class="mb-2">
                    {% if is_author %}
                        <span class="author-status status-approved">
                            ‚úÖ –°—Ç–∞—Ç—É—Å: –ê–≤—Ç–æ—Ä
                        </span>
                    {% elif author_request %}
                        {% if author_request.status == 'pending' %}
                            <span class="author-status status-pending">
                                ‚è≥ –ó–∞—è–≤–∫–∞ –Ω–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–∏
                            </span>
                        {% elif author_request.status == 'rejected' %}
                            <span class="author-status status-rejected">
                                ‚ùå –ó–∞—è–≤–∫–∞ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∞
                            </span>
                        {% endif %}
                    {% else %}
                        <span class="author-status status-none">
                            üìù –°—Ç–∞—Ç—É—Å: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
                        </span>
                    {% endif %}
                </div>
                
                <div class="action-buttons">
                    <a href="{% url 'Blog:edit_profile' %}" class="btn btn-primary-custom">
                        ‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å
                    </a>
                    <a href="{% url 'Blog:post_create' %}" class="btn btn-success-custom">
                        ‚ûï –°–æ–∑–¥–∞—Ç—å –ø–æ—Å—Ç
                    </a>
                    <a href="{% url 'Archive:file_upload' %}" class="btn btn-info-custom">
                        üìÅ –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="container">
    <div class="row">
        <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
        <div class="col-md-3">
            <div class="stats-card text-center">
                <div class="stats-number">{{ user_profile.posts_count }}</div>
                <div class="text-muted">üìù –ü–æ—Å—Ç–æ–≤</div>
            </div>
        </div>
        
        <div class="col-md-3">
            <div class="stats-card text-center">
                <div class="stats-number">{{ files_count|default:0 }}</div>
                <div class="text-muted">üìÅ –§–∞–π–ª–æ–≤</div>
            </div>
        </div>
        
        <div class="col-md-3">
            <div class="stats-card text-center">
                <div class="stats-number">{{ user_profile.followers_count }}</div>
                <div class="text-muted">üë• –ü–æ–¥–ø–∏—Å—á–∏–∫–æ–≤</div>
            </div>
        </div>
        
        <div class="col-md-3">
            <div class="stats-card text-center">
                <div class="stats-number">{{ user_profile.following_count }}</div>
                <div class="text-muted">‚úÖ –ü–æ–¥–ø–∏—Å–æ–∫</div>
            </div>
        </div>
    </div>
    
    <div class="row">
        <!-- –ù–µ–¥–∞–≤–Ω–∏–µ –ø–æ—Å—Ç—ã -->
        <div class="col-md-6">
            <div class="card">
                <div class="card-header bg-primary text-white">
                    <h5 class="mb-0">üì∞ –ú–æ–∏ –Ω–µ–¥–∞–≤–Ω–∏–µ –ø–æ—Å—Ç—ã</h5>
                </div>
                <div class="card-body">
                    {% if user_posts %}
                        <div class="recent-posts">
                            {% for post in user_posts %}
                            <div class="post-item">
                                <h6 class="mb-1">
                                    <a href="{% url 'Blog:post_detail' post.slug %}" class="text-decoration-none">
                                        {{ post.title }}
                                    </a>
                                </h6>
                                <small class="text-muted">
                                    üìÖ {{ post.created_at|date:"d.m.Y" }} | 
                                    üëÅÔ∏è {{ post.views_count }} –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤ |
                                    ‚ù§Ô∏è {{ post.likes_count }} –ª–∞–π–∫–æ–≤
                                </small>
                            </div>
                            {% endfor %}
                        </div>
                        
                        <div class="text-center mt-3">
                            <a href="{% url 'Blog:user_profile' user.username %}" class="btn btn-outline-primary">
                                –í—Å–µ –º–æ–∏ –ø–æ—Å—Ç—ã ‚Üí
                            </a>
                        </div>
                    {% else %}
                        <div class="text-center py-4">
                            <i class="fas fa-edit fa-3x text-muted mb-3"></i>
                            <h6 class="text-muted">–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –ø–æ—Å—Ç–æ–≤</h6>
                            <a href="{% url 'Blog:post_create' %}" class="btn btn-primary mt-2">
                                –°–æ–∑–¥–∞—Ç—å –ø–µ—Ä–≤—ã–π –ø–æ—Å—Ç
                            </a>
                        </div>
                    {% endif %}
                </div>
            </div>
        </div>
        
        <!-- –ó–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã -->
        <div class="col-md-6">
            <div class="card">
                <div class="card-header bg-info text-white">
                    <h5 class="mb-0">üìÅ –ú–æ–∏ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã</h5>
                </div>
                <div class="card-body">
                    {% if user_files %}
                        <div class="recent-posts">
                            {% for file in user_files %}
                            <div class="post-item">
                                <h6 class="mb-1">
                                    <a href="{% url 'Archive:file_detail' file.pk %}" class="text-decoration-none">
                                        {{ file.title }}
                                    </a>
                                </h6>
                                <small class="text-muted">
                                    üìÖ {{ file.uploaded_at|date:"d.m.Y" }} | 
                                    üì• {{ file.downloads_count }} —Å–∫–∞—á–∏–≤–∞–Ω–∏–π |
                                    üëÅÔ∏è {{ file.views_count }} –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤
                                    {% if not file.is_public %}
                                        | ‚è≥ –ù–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏
                                    {% endif %}
                                </small>
                            </div>
                            {% endfor %}
                        </div>
                        
                        <div class="text-center mt-3">
                            <a href="{% url 'Archive:user_files' %}" class="btn btn-outline-info me-2">
                                –ú–æ–∏ —Ñ–∞–π–ª—ã ‚Üí
                            </a>
                            <a href="{% url 'Archive:index' %}" class="btn btn-outline-secondary">
                                –í—Å–µ —Ñ–∞–π–ª—ã –≤ –∞—Ä—Ö–∏–≤–µ ‚Üí
                            </a>
                        </div>
                    {% else %}
                        <div class="text-center py-4">
                            <i class="fas fa-file-upload fa-3x text-muted mb-3"></i>
                            <h6 class="text-muted">–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤</h6>
                            {% if is_author %}
                                <a href="{% url 'Archive:file_upload' %}" class="btn btn-info mt-2">
                                    –ó–∞–≥—Ä—É–∑–∏—Ç—å –ø–µ—Ä–≤—ã–π —Ñ–∞–π–ª
                                </a>
                            {% else %}
                                <p class="text-muted small mt-2">–î–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç—É—Å –∞–≤—Ç–æ—Ä–∞</p>
                            {% endif %}
                        </div>
                    {% endif %}
                </div>
            </div>
        </div>
        
        <!-- –ë–æ–∫–æ–≤–∞—è –ø–∞–Ω–µ–ª—å —Å –¥–µ–π—Å—Ç–≤–∏—è–º–∏ -->
        <div class="col-md-4">
            <!-- –ó–∞—è–≤–∫–∞ –Ω–∞ —Å—Ç–∞—Ç—É—Å –∞–≤—Ç–æ—Ä–∞ -->
            <div class="card mb-4">
                <div class="card-header bg-success text-white">
                    <h6 class="mb-0">üéØ –°—Ç–∞—Ç—å –∞–≤—Ç–æ—Ä–æ–º</h6>
                </div>
                <div class="card-body">
                    {% if is_author %}
                        <p class="card-text">üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –í—ã —è–≤–ª—è–µ—Ç–µ—Å—å –∞–≤—Ç–æ—Ä–æ–º –∏ –º–æ–∂–µ—Ç–µ —Å–æ–∑–¥–∞–≤–∞—Ç—å —Å—Ç–∞—Ç—å–∏.</p>
                        <div class="mb-3">
                            <span class="author-status status-approved">
                                ‚úÖ –í—ã –∞–≤—Ç–æ—Ä
                            </span>
                        </div>
                        <a href="{% url 'Blog:post_create' %}" class="btn btn-success btn-sm w-100">
                            ‚ûï –°–æ–∑–¥–∞—Ç—å —Å—Ç–∞—Ç—å—é
                        </a>
                    {% elif author_request %}
                        {% if author_request.status == 'pending' %}
                            <p class="card-text">‚è≥ –í–∞—à–∞ –∑–∞—è–≤–∫–∞ –Ω–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–∏. –û–∂–∏–¥–∞–π—Ç–µ —Ä–µ—à–µ–Ω–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞.</p>
                            <div class="mb-3">
                                <span class="author-status status-pending">
                                    –ó–∞—è–≤–∫–∞ –ø–æ–¥–∞–Ω–∞ {{ author_request.created_at|date:"d.m.Y" }}
                                </span>
                            </div>
                            <small class="text-muted">–°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏—è: 1-3 –¥–Ω—è</small>
                        {% elif author_request.status == 'rejected' %}
                            <p class="card-text">‚ùå –ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, –≤–∞—à–∞ –∑–∞—è–≤–∫–∞ –±—ã–ª–∞ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∞.</p>
                            {% if author_request.admin_comment %}
                                <div class="alert alert-warning">
                                    <small><strong>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π:</strong> {{ author_request.admin_comment }}</small>
                                </div>
                            {% endif %}
                            <div class="mb-3">
                                <span class="author-status status-rejected">
                                    –û—Ç–∫–ª–æ–Ω–µ–Ω–∞ {{ author_request.reviewed_at|date:"d.m.Y" }}
                                </span>
                            </div>
                            <a href="{% url 'Blog:author_request' %}" class="btn btn-warning btn-sm w-100">
                                üîÑ –ü–æ–¥–∞—Ç—å –Ω–æ–≤—É—é –∑–∞—è–≤–∫—É
                            </a>
                        {% endif %}
                    {% else %}
                        <p class="card-text">–ü–æ–¥–∞–π—Ç–µ –∑–∞—è–≤–∫—É –Ω–∞ –ø–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –∞–≤—Ç–æ—Ä–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∏ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ —Å—Ç–∞—Ç–µ–π.</p>
                        <div class="mb-3">
                            <span class="author-status status-none">
                                –ó–∞—è–≤–∫–∞ –Ω–µ –ø–æ–¥–∞–Ω–∞
                            </span>
                        </div>
                        <a href="{% url 'Blog:author_request' %}" class="btn btn-success btn-sm w-100">
                            üìù –ü–æ–¥–∞—Ç—å –∑–∞—è–≤–∫—É
                        </a>
                    {% endif %}
                </div>
            </div>
            
            <!-- –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è -->
            <div class="card">
                <div class="card-header bg-info text-white">
                    <h6 class="mb-0">‚ö° –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è</h6>
                </div>
                <div class="card-body">
                    <div class="d-grid gap-2">
                        <a href="{% url 'Blog:post_list' %}" class="btn btn-outline-primary btn-sm">
                            üìö –í—Å–µ –ø–æ—Å—Ç—ã
                        </a>
                        <a href="{% url 'Archive:user_files' %}" class="btn btn-outline-info btn-sm">
                            üìÅ –ú–æ–∏ —Ñ–∞–π–ª—ã
                        </a>
                        <a href="{% url 'Archive:index' %}" class="btn btn-outline-secondary btn-sm">
                            üìÅ –ê—Ä—Ö–∏–≤ —Ñ–∞–π–ª–æ–≤
                        </a>
                        <a href="{% url 'Blog:index' %}" class="btn btn-outline-info btn-sm">
                            üè† –ì–ª–∞–≤–Ω–∞—è –±–ª–æ–≥–∞
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}